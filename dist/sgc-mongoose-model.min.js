define("RemoteCollection/mixins/sync",[],function(){return function(t){return{url:function(){return this._customUrl?this._customUrl:this._parent?_.result(this._parent,"url")+"/"+this._path||"":void 0},fetch:function(e){return e=_.defaults(e||{},{paginate:!1,filters:!0,sorts:!0}),e.filters&&this.hasFilters()&&this.appendFiltersData(e),e.sorts&&this.hasSorts()&&this.appendSortsData(e),e.paginate&&this.appendPaginateData(e),t.prototype.fetch.apply(this,[e])}}}}),define("RemoteCollection/mixins/pagination",[],function(){return function(){return{configurePagination:function(){this.resetPaginate()},setPerPage:function(t){this.getSGPaginate().perPage=t},getSGPaginate:function(){return this._paginate||this.resetPaginate(),this._paginate},resetPaginate:function(){this._paginate={currentPage:0,perPage:0,maxPagesReached:!1},this._firstPage=!0},setMaxPagesReached:function(){this.getSGPaginate().maxPagesReached=!0},isMaxReached:function(){return this.getSGPaginate().maxPagesReached},nextPage:function(t){return t=_.extend(t||{},{paginate:!0}),this.fetch(t)},configureSorts:function(){this.resetSGSort()},configureFilters:function(){this.resetSGFilters()},computeOffsetPage:function(){return this.getSGPaginate().currentPage*this.getSGPaginate().perPage},computeLimitPage:function(){return this.getSGPaginate().perPage},appendPaginateData:function(t){if(t=_.defaults(t||{},{data:{}}),void 0!==t.data.offset)throw new Error("Already an offset");if(void 0!==t.data.limit)throw new Error("Already a limit");var e=t.success;return t.success=function(t,i,r){e&&e.apply(this,arguments),t._firstPage=!1,r.parse&&(i=t.parse(i,r)),t.getSGPaginate().currentPage++,i.length<r.data.limit&&t.setMaxPagesReached()},t.data.offset=this.computeOffsetPage(),t.data.limit=this.computeLimitPage(),this._firstPage?t.reset=!0:(t.reset=!1,t.remove=!1),t},resetSGSort:function(){this._sorts={}},getSGSort:function(){return this._sorts||(this._sorts={}),this._sorts},getSortLimit:function(){return 1},hasSorts:function(){return!!_.keys(this.getSGSort()).length},addSGSort:function(t,e,i){i=_.defaults(i||{},{silent:!1}),e=e||"asc",this.hasSorts()&&this.resetSGSort({silent:i.silent}),this.getSGSort()[t]=e,i.silent||this.trigger("add:sort",t,e)},removeSGSort:function(t,e){e=_.defaults(e||{},{silent:!1}),void 0!==this.getSGSort()[t]&&(delete this.getSGSort()[t],e.silent||this.trigger("remove:sort",t))},resetSGFilters:function(){this._filters={}},getSGFilters:function(){return this._filters||(this._filters={}),this._filters},addSGFilter:function(t,e,i){i=_.defaults(i||{},{silent:!1}),this.getSGFilters()[t]=e,i.silent||this.trigger("add:filter",t,e)},removeSGFilter:function(t,e){e=_.defaults(e||{},{silent:!1}),void 0!==this.getSGFilters()[t]&&(delete this.getSGFilters()[t],e.silent||this.trigger("remove:filter",t))},hasFilters:function(){return!!_.keys(this.getSGFilters()).length},appendFiltersData:function(t){if(t=_.defaults(t||{},{data:{}}),!this.hasFilters())return t;var e=this.getSGFilters();for(var i in e)t.data[encodeURIComponent(i)]=encodeURIComponent(e[i]);return t},appendSortsData:function(t){if(t=_.defaults(t||{},{data:{}}),!this.hasSorts())return t;var e=this.getSGSort();for(var i in e)t.data.sortBy=encodeURIComponent(i),t.data.sortHow=encodeURIComponent(e[i]);return t}}}}),define("RemoteCollection/mixins/helpers",[],function(){return function(t){return{__wrapIdInsideAttrs:function(t){var e={};return e[this.model.prototype.idAttribute]=t,e},set:function(e,i){if(_.isArray(e))for(var r=e.length-1;r>=0;r--)_.isString(e[r])&&(e[r]=this.__wrapIdInsideAttrs(e[r]));return _.isString(e)&&(e=this.__wrapIdInsideAttrs(e)),t.prototype.set.apply(this,[e,i])}}}}),define("RemoteCollection/mixins/navigation",[],function(){return function(){return{navigateRepresentation:function(){var t="";return this.constructor.getCollectionName()&&(t=this.constructor.getCollectionName()),this._parent&&this._path&&(t=this._parent.navigateRepresentation()+"/"+this._path),t}}}}),define("shared/actions_mixin",[],function(){return function(){return{getActions:function(){return this._actions||(this._actions={}),this._actions},hasAction:function(t){return t in this.getActions()},getActionDescriptor:function(t){return this.getActions()[t]},addAction:function(t,e){this.getActions()[t]=e},removeAction:function(t){delete this.getActions()[t]},generateAction:function(t,e){if(this.hasAction(t))throw new Error("action already defined");e=_.defaults(e||{},{method:"POST"}),this.addAction(t,e)},executeAction:function(t,e,i){if(!this.hasAction(t))throw new Error("Unknow action",t);e=e||{};var r=this.getActionDescriptor(t),n=_.extend(_.clone(r),{data:e}),o=_.extend(n,i);return o.url||(o.url=this.generateUrlForAction(t)),this.sync(void 0,this,o)},generateUrlForAction:function(t){var e=_.result(this,"url");return e+="/"+t}}}}),define("shared/ModelError",[],function(){var t=function(t){t=_.defaults(t||{},{verbose:"Unknow",identifier:0,model:null}),this.verbose=t.verbose,this.identifier=t.identifier,this.model=t.model};return _.extend(t.prototype,{clear:function(){this.model=null,this.identifier=null,this.verbose=null}}),t}),define("shared/error_mixin",["./ModelError"],function(t){return function(){return{generateError:function(t,e){return new this._ModelError({verbose:t,identifier:e,model:this})},_ModelError:t}}}),define("shared/classShared_mixin",[],function(){return function(){return{modelName:null,getCollectionName:function(){return _.isString(this.modelName)?this.modelName.toLowerCase()+"s":""}}}}),define("RemoteModel/mixins/sync",[],function(){return function(){return{urlRoot:function(){return this._customUrl?this._customUrl:this._parent?_.result(this._parent,"url")+"/"+this._path||"":this.collection?_.result(this.collection,"url"):"/api/"+this.constructor.getCollectionName()}}}}),define("RemoteModel/descriptor/Descriptor",[],function(){var t=function(t){_.extend(this,t)};return _.extend(t.prototype,{clear:function(){for(var t in this)"clear"!==t&&(this[t]=null)},isValidable:function(){return!0}}),t}),define("RemoteModel/mixins/schema",["./../descriptor/Descriptor"],function(t){return function(){return{configureSchema:function(){},_getSchemaAttributes:function(){return this.__schemaAttributes||(this.__schemaAttributes={}),this.__schemaAttributes},_addSchemaAttribute:function(e,i){if(e){if(this._hasSchemaAttribute(e))throw new Error("Attribute already use");var r=new t(i);this._getSchemaAttributes()[e]=r}},_removeSchemaAttribute:function(t){this._hasSchemaAttribute(t)&&(this._getSchemaAttributes()[t].clear(),delete this._getSchemaAttributes()[t])},_hasSchemaAttribute:function(t){return void 0!==this._getSchemaDescription(t)},_getSchemaDescription:function(t){return this._getSchemaAttributes()[t]},generateSchemaAttribute:function(t,e){if(this._hasSchemaAttribute(t))throw new Error("Attribute already use");return e=_.defaults(e||{},{type:"PRIMITIVE",attribute:t}),this._addSchemaAttribute(t,e),this._generateGetSetForAttribute.apply(this,[t,e])}}}}),define("RemoteModel/mixins/getter",[],function(){return function(t){return{get:function(e,i){if(i=_.defaults(i||{},{lazyCreation:!0}),this._hasSchemaAttribute(e)&&i.lazyCreation&&!this.has(e)){var r=this.tryGenerateDefaultValue(this._getSchemaDescription(e));return this.set(e,r,{force:!0}),r}return t.prototype.get.apply(this,arguments)},has:function(t){return!!this.get(t,{lazyCreation:!1})}}}}),define("RemoteModel/mixins/setter",[],function(){return function(t){return{set:function(e,i,r){if(r=_.defaults(r||{},{force:!1}),_.isObject(e)){for(var n in e)this.set(n,e[n],r);return this}if(this._hasSchemaAttribute(e)&&!r.force){var o=_.clone(r);return this.setSchemaAttribute(e,i,o)}return t.prototype.set.apply(this,arguments)},setSchemaAttribute:function(t,e,i){var r=this._getSchemaDescription(t);if(r)switch(r.type){case"PRIMITIVE":return this.setPrimitiveAttribute(t,e,i);case"MODEL":return this.setModelAttribute(t,e,i);case"COLLECTION":return this.setCollectionAttribute(t,e,i);default:return}},setPrimitiveAttribute:function(t,e){return this.set(t,e,{force:!0})},setModelAttribute:function(e,i,r){if(i instanceof t)return this.get(e,{lazyCreation:!1})&&this.get(e).clear(),this.set(e,i,{force:!0});if(_.isString(i)){var n=i;i={},i[this._getSchemaDescription(e).generetor.prototype.idAttribute]=n}var o=this.get(e).set(i);return this.trigger("change:"+e,this,i,r),o},setCollectionAttribute:function(t,e,i){if(e instanceof Backbone.Collection)return this.get(t,{lazyCreation:!1})&&this.get(t).clear(),void this.set(t,e,{force:!0});if(!_.isArray(e))throw new Error("Strange raw data for collection expect an array");var r=this.get(t).set(e);return this.trigger("change:"+t,this,e,i),r}}}}),define("RemoteModel/mixins/getterCreator",[],function(){return function(){return{tryGenerateDefaultValue:function(t){if(!t)throw new Error("Unknow type");switch(t.type){case"PRIMITIVE":return this.generateDefaultPrimitiveForAttribute(t);case"COLLECTION":return this.generateDefaultCollectionForAttribute(t);case"MODEL":return this.generateDefaultModelForAttribute(t);default:throw new Error("Unknow type")}},generateDefaultModelForAttribute:function(t){return t=_.defaults(t||{},{generator:this.constructor,defaultOptions:{},path:t.attribute}),_.extend(t.defaultOptions,{parent:this,path:t.attribute}),new t.generator(t.defaultAttrs,t.defaultOptions)},generateDefaultCollectionForAttribute:function(t){if(t=_.defaults(t||{},{defaultOptions:{},path:t.attribute}),!t.generator)throw new Error("Unknow collection generator");return _.extend(t.defaultOptions,{parent:this,path:t.attribute}),t=t||{},new t.generator(t.defaultModels,t.defaultOptions)},generateDefaultPrimitiveForAttribute:function(t){return t=t||{},t["default"]}}}}),define("RemoteModel/mixins/lifeCycle",[],function(){return function(t){return{clear:function(){return this._parent=null,t.prototype.clear.apply(this,arguments)}}}}),define("RemoteModel/mixins/validation",[],function(){return function(){return{validate:function(t,e){t=t||_.keys(this._getSchemaAttributes());for(var i=t.length-1;i>=0;i--)if(!(t[i]in this.attributes||t[i]in this._getSchemaAttributes()))throw new Error("unknow attributes to validate ("+t[i]+")");var r=_.intersection(_.keys(this._getSchemaAttributes()),t),n=null;for(i=r.length-1;i>=0;i--){var o=_.clone(e);if(n=this.validateAttribute(r[i],o))return n}},validateAttribute:function(t,e){e=_.defaults(e||{},{lazyCreation:!0});var i=this._getSchemaDescription(t);if(i.isValidable()){e=_.clone(e);var r=this.get(t,{lazyCreation:e.lazyCreation}),n=_.clone(e);n.lazyCreation=!1;var o=r&&r.validate(void 0,n);if(o)return o}}}}}),define("RemoteModel/mixins/navigation",[],function(){return function(){return{navigateRepresentation:function(){var t="";return this._parent&&(t=this._parent.navigateRepresentation()+"/"+this._path||""),this.collection&&(t=this.collection.navigateRepresentation()),t||(t=this.constructor.getCollectionName()),t+"/"+(this.isNew()?"new":this.id)}}}}),define("RemoteModel/Model",["./mixins/sync","./mixins/schema","./mixins/getter","./mixins/setter","./mixins/getterCreator","./mixins/lifeCycle","./mixins/validation","./mixins/navigation","./../shared/actions_mixin","./../shared/error_mixin","./../shared/classShared_mixin"],function(t,e,i,r,n,o,s,a,u,c,h){var l=require("sgc-model").Model,f=_.extend({},h(l)),d=l.extend({constructor:function(t,e){e=_.defaults(e||{},{parent:null,path:null});var i=l.prototype.constructor.apply(this,arguments);return this._path=e.path,this._parent=e.parent,this.configureSchema(),i},idAttribute:"_id"},f);return _.extend(d.prototype,t(l)),_.extend(d.prototype,e(l)),_.extend(d.prototype,i(l)),_.extend(d.prototype,r(l)),_.extend(d.prototype,n(l)),_.extend(d.prototype,o(l)),_.extend(d.prototype,s(l)),_.extend(d.prototype,a(l)),_.extend(d.prototype,u(l)),_.extend(d.prototype,c(l)),d}),define("RemoteCollection/Collection",["./mixins/sync","./mixins/pagination","./mixins/helpers","./mixins/navigation","./../shared/actions_mixin","./../shared/error_mixin","./../shared/classShared_mixin","./../RemoteModel/Model"],function(t,e,i,r,n,o,s,a){var u=require("sgc-model").Collection,c=_.extend({},s(u)),h=u.extend({constructor:function(t,e){e=_.defaults(e||{},{parent:null,path:null}),e.url&&(this._customUrl=e.url,delete e.url);var i=u.prototype.constructor.apply(this,arguments);return this._parent=e.parent,this._path=e.path,this.configurePagination(),this.configureSorts(),this.configureFilters(),i},model:a},c);return _.extend(h.prototype,t(u)),_.extend(h.prototype,e(u)),_.extend(h.prototype,i(u)),_.extend(h.prototype,r(u)),_.extend(h.prototype,n(u)),_.extend(h.prototype,o(u)),h}),define("sgc-mongoose-model",["./RemoteCollection/Collection","./RemoteModel/Model"],function(t,e){return{Collection:t,Model:e}});